{"version":3,"sources":["../../source/write/writeXlsxFileBrowser.js"],"names":["writeXlsxFile","data","fileName","rest","generateXlsxFile","then","blob","FileSaver","saveAs","sheetName","sheet","sheetNames","sheets","schema","columns","headerStyle","fontFamily","fontSize","dateFormat","zip","JSZip","file","rels","contentTypes","getSharedStringsXml","getStylesXml","xl","folder","id","generateAsync","type","mimeType"],"mappings":";;;;;;;AAGA;;AACA;;AAEA;;AACA;;AACA;;AACA;;AAEA;;;;;;;;;;;;;;;;AAEe,SAASA,aAAT,CAAuBC,IAAvB,EAAyD;AAAA,iFAAJ,EAAI;AAAA,MAA1BC,QAA0B,QAA1BA,QAA0B;AAAA,MAAbC,IAAa;;AACtE,SAAOC,gBAAgB,CAACH,IAAD,EAAOE,IAAP,CAAhB,CAA6BE,IAA7B,CAAkC,UAACC,IAAD,EAAU;AACjD,QAAIJ,QAAJ,EAAc;AACZ,aAAOK,sBAAUC,MAAV,CAAiBF,IAAjB,EAAuBJ,QAAvB,CAAP;AACD;;AACD,WAAOI,IAAP;AACD,GALM,CAAP;AAMD;AAED;AACA;AACA;AACA;AACA;AACA;;;AACA,SAASF,gBAAT,CAA0BH,IAA1B,SASG;AAAA,MARMQ,SAQN,SARDC,KAQC;AAAA,MAPOC,UAOP,SAPDC,MAOC;AAAA,MANDC,MAMC,SANDA,MAMC;AAAA,MALDC,OAKC,SALDA,OAKC;AAAA,MAJDC,WAIC,SAJDA,WAIC;AAAA,MAHDC,UAGC,SAHDA,UAGC;AAAA,MAFDC,QAEC,SAFDA,QAEC;AAAA,MADDC,UACC,SADDA,UACC;AACD,MAAMC,GAAG,GAAG,IAAIC,iBAAJ,EAAZ;AAEAD,EAAAA,GAAG,CAACE,IAAJ,CAAS,aAAT,EAAwBC,gBAAxB;AACAH,EAAAA,GAAG,CAACE,IAAJ,CAAS,qBAAT,EAAgCE,yBAAhC;;AAEA,wBAII,mCAAe;AACjBtB,IAAAA,IAAI,EAAJA,IADiB;AAEjBQ,IAAAA,SAAS,EAATA,SAFiB;AAGjBE,IAAAA,UAAU,EAAVA,UAHiB;AAIjBE,IAAAA,MAAM,EAANA,MAJiB;AAKjBC,IAAAA,OAAO,EAAPA,OALiB;AAMjBC,IAAAA,WAAW,EAAXA,WANiB;AAOjBC,IAAAA,UAAU,EAAVA,UAPiB;AAQjBC,IAAAA,QAAQ,EAARA,QARiB;AASjBC,IAAAA,UAAU,EAAVA;AATiB,GAAf,CAJJ;AAAA,MACEN,MADF,mBACEA,MADF;AAAA,MAEEY,mBAFF,mBAEEA,mBAFF;AAAA,MAGEC,YAHF,mBAGEA,YAHF;;AAgBA,MAAMC,EAAE,GAAGP,GAAG,CAACQ,MAAJ,CAAW,IAAX,CAAX;AACAD,EAAAA,EAAE,CAACL,IAAH,CAAQ,yBAAR,EAAmC,6BAAwB;AAAET,IAAAA,MAAM,EAANA;AAAF,GAAxB,CAAnC;AACAc,EAAAA,EAAE,CAACL,IAAH,CAAQ,cAAR,EAAwB,0BAAoB;AAAET,IAAAA,MAAM,EAANA;AAAF,GAApB,CAAxB;AACAc,EAAAA,EAAE,CAACL,IAAH,CAAQ,YAAR,EAAsBI,YAAY,EAAlC;AACAC,EAAAA,EAAE,CAACL,IAAH,CAAQ,mBAAR,EAA6BG,mBAAmB,EAAhD;;AAEA,uDAA2BZ,MAA3B,wCAAmC;AAAA;AAAA,QAAtBgB,EAAsB,eAAtBA,EAAsB;AAAA,QAAlB3B,KAAkB,eAAlBA,IAAkB;AACjCyB,IAAAA,EAAE,CAACL,IAAH,2BAA2BO,EAA3B,WAAqC3B,KAArC;AACD;;AAED,SAAOkB,GAAG,CAACU,aAAJ,CAAkB;AACvBC,IAAAA,IAAI,EAAE,MADiB;AAEvBC,IAAAA,QAAQ,EAAE;AAFa,GAAlB,CAAP;AAID","sourcesContent":["// Copy-pasted from:\r\n// https://github.com/davidramos-om/zipcelx-on-steroids/blob/master/src/zipcelx.js\r\n\r\nimport JSZip from 'jszip'\r\nimport FileSaver from 'file-saver'\r\n\r\nimport generateWorkbookXml from './statics/workbook.xml'\r\nimport generateWorkbookXmlRels from './statics/workbook.xml.rels'\r\nimport rels from './statics/rels'\r\nimport contentTypes from './statics/[Content_Types].xml'\r\n\r\nimport { generateSheets } from './writeXlsxFile.common'\r\n\r\nexport default function writeXlsxFile(data, { fileName, ...rest } = {}) {\r\n  return generateXlsxFile(data, rest).then((blob) => {\r\n    if (fileName) {\r\n      return FileSaver.saveAs(blob, fileName)\r\n    }\r\n    return blob\r\n  })\r\n}\r\n\r\n/**\r\n * Writes an *.xlsx file into a \"blob\".\r\n * https://github.com/egeriis/zipcelx/issues/68\r\n * \"The reason if you want to send the excel file or store it natively on Cordova/capacitor app\".\r\n * @return {Blob}\r\n */\r\nfunction generateXlsxFile(data, {\r\n  sheet: sheetName,\r\n  sheets: sheetNames,\r\n  schema,\r\n  columns,\r\n  headerStyle,\r\n  fontFamily,\r\n  fontSize,\r\n  dateFormat\r\n}) {\r\n  const zip = new JSZip()\r\n\r\n  zip.file('_rels/.rels', rels)\r\n  zip.file('[Content_Types].xml', contentTypes)\r\n\r\n  const {\r\n    sheets,\r\n    getSharedStringsXml,\r\n    getStylesXml\r\n  } = generateSheets({\r\n    data,\r\n    sheetName,\r\n    sheetNames,\r\n    schema,\r\n    columns,\r\n    headerStyle,\r\n    fontFamily,\r\n    fontSize,\r\n    dateFormat\r\n  })\r\n\r\n  const xl = zip.folder('xl')\r\n  xl.file('_rels/workbook.xml.rels', generateWorkbookXmlRels({ sheets }))\r\n  xl.file('workbook.xml', generateWorkbookXml({ sheets }))\r\n  xl.file('styles.xml', getStylesXml())\r\n  xl.file('sharedStrings.xml', getSharedStringsXml())\r\n\r\n  for (const { id, data } of sheets) {\r\n    xl.file(`worksheets/sheet${id}.xml`, data)\r\n  }\r\n\r\n  return zip.generateAsync({\r\n    type: 'blob',\r\n    mimeType: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'\r\n  })\r\n}"],"file":"writeXlsxFileBrowser.js"}